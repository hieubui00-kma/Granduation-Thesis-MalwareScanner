package com.kma.malwarescanner.core.data.local.model

import android.content.pm.PackageInfo
import com.kma.malwarescanner.core.domain.data.model.Application
import java.util.Date

@Suppress("DEPRECATION")
internal fun PackageInfo.asModel(name: String): Application {
    val version = versionName.orEmpty()
    val installDate = Date(firstInstallTime)
    val updatedDate = Date(lastUpdateTime)
    val permissions = requestedPermissions?.toList() ?: emptyList()

    return Application(
        name = name,
        packageName = packageName,
        version = version,
        installDate = installDate,
        updatedDate = updatedDate,
        sourceDir = applicationInfo.sourceDir,
        permissions = permissions,
        type = null
    )
}
