package com.kma.malwarescanner.core.data.model

import android.content.pm.PackageInfo
import com.kma.malwarescanner.core.domain.data.model.Application
import com.kma.malwarescanner.core.domain.data.model.MalwareType
import java.util.Date

internal fun PackageInfo.asModel(name: String, type: MalwareType?): Application {
    val version = versionName.orEmpty()
    val installDate = Date(firstInstallTime)
    val updatedDate = Date(lastUpdateTime)
    val permissions = requestedPermissions?.toList() ?: emptyList()

    return Application(
        name = name,
        packageName = packageName,
        version = version,
        installDate = installDate,
        updatedDate = updatedDate,
        sourceDir = applicationInfo.sourceDir,
        permissions = permissions,
        type = type?.name
    )
}
