package com.kma.malwarescanner.core.data.model

import com.kma.apktool.data.model.ApkMetadata
import com.kma.malwarescanner.core.domain.data.model.Application
import java.util.Date

internal fun ApkMetadata.asModel(
    size: Long,
    installDate: Date?,
    updatedDate: Date?,
    sourceDir: String,
): Application {
    return Application(
        name = this.name,
        packageName = this.packageName,
        version = this.versionName,
        size = size,
        installDate = installDate,
        updatedDate = updatedDate,
        userFeatures = this.userFeatures.toList(),
        permissions = this.permissions.toList(),
        activities = this.activities.toList(),
        services = this.services.toList(),
        receivers = this.receivers.toList(),
        providers = this.providers.toList(),
        sourceDir = sourceDir,
    )
}
