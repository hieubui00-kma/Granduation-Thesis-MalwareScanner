package com.kma.malwarescanner.core.data.model

import com.kma.malwarescanner.core.domain.data.model.Application
import com.kma.malwarescanner.core.domain.data.model.MalwareType
import net.dongliu.apk.parser.bean.ApkMeta
import java.util.Date

internal fun ApkMeta.asModel(
    sourceDir: String,
    installDate: Date?,
    updatedDate: Date?,
    type: MalwareType?
): Application {
    return Application(
        name = name,
        packageName = packageName,
        version = versionName,
        installDate = installDate,
        updatedDate = updatedDate,
        sourceDir = sourceDir,
        permissions = usesPermissions,
        type = type?.name
    )
}
