package com.kma.malwarescanner.core.data.local.model

import android.content.pm.ApplicationInfo
import android.content.pm.ApplicationInfo.FLAG_SYSTEM
import android.content.pm.ApplicationInfo.FLAG_UPDATED_SYSTEM_APP
import com.kma.malwarescanner.core.domain.data.model.Application

internal val ApplicationInfo.isSystemApplication: Boolean
    get() = flags and FLAG_SYSTEM != 0 || flags and FLAG_UPDATED_SYSTEM_APP != 0

@Suppress("DEPRECATION")
internal fun ApplicationInfo.asModel(name: String): Application {

    return Application(
        name = name,
        packageName = packageName,
        version = null,
        installDate = null,
        updatedDate = null,
        sourceDir = sourceDir,
        permissions = emptyList(),
        type = null
    )
}
