package com.kma.malwarescanner.feature.applicationdetails.ui.component

import androidx.compose.animation.AnimatedContent
import androidx.compose.animation.ExperimentalAnimationApi
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.runtime.Composable
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import com.kma.malwarescanner.feature.applicationdetails.ui.ApplicationDetailsState

@Composable
@OptIn(ExperimentalAnimationApi::class)
fun AnalyzeSection(
    state: ApplicationDetailsState,
    onAnalyzePressed: () -> Unit,
    modifier: Modifier,
    contentAlignment: Alignment = Alignment.Center
) {
    AnimatedContent(
        targetState = state,
        modifier = modifier,
        contentAlignment = contentAlignment
    ) { targetState ->
        when {
            targetState.isAnalyzing -> LoadingBox()

            targetState.malwareType.isNullOrEmpty() -> AnalyzeButton(
                onClick = onAnalyzePressed,
                modifier = Modifier.fillMaxSize()
            )

            else -> MalwareTypeCard(
                malwareType = targetState.malwareType,
                isMalware = targetState.malwareType != "Benign",
                modifier = Modifier.fillMaxSize()
            )
        }
    }
}
